<!DOCTYPE html>
<html>
<head>
  <style>
    .error {
        color: red;
    }
  </style>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega@5"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-lite@4.8.1"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-embed@6"></script>
</head>
<body>
  <div id="vis"></div>
  <script>
    (function(vegaEmbed) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "vconcat": [{"data": {"name": "data-3d9a2397bdff9d91fbe86ee2d06fb6ed"}, "mark": {"type": "text", "fontSize": 20}, "encoding": {"text": {"type": "quantitative", "field": "irr", "format": ".2%"}}, "title": "IRR", "transform": [{"filter": "((datum.start_year <= selector021.year) && (datum.start_yearplus1 > selector021.year))"}]}, {"hconcat": [{"layer": [{"mark": "line", "encoding": {"x": {"type": "quantitative", "field": "year"}, "y": {"type": "quantitative", "field": "pd_profile"}}}, {"mark": {"type": "point", "opacity": 0}, "encoding": {"x": {"type": "quantitative", "field": "year"}}, "selection": {"selector021": {"type": "single", "encodings": ["x"], "nearest": true, "on": "click", "init": {"x": 0}}}}, {"mark": {"type": "line", "color": "orange"}, "encoding": {"x": {"type": "quantitative", "field": "year"}, "y": {"type": "quantitative", "field": "pd_profile"}}, "transform": [{"filter": "((datum.year >= selector021.year) && (datum.yearmin5 <= selector021.year))"}]}, {"mark": "point", "encoding": {"x": {"type": "quantitative", "field": "year"}, "y": {"type": "quantitative", "field": "pd_profile"}}, "transform": [{"filter": {"selection": "selector021"}}]}], "data": {"name": "data-6fe77d56cec7e6c5eb876c8fd2c278ac"}}, {"layer": [{"mark": "rect", "encoding": {"color": {"condition": {"value": "grey", "test": "(datum.x0 > datum.x1)"}, "value": "steelblue"}, "x": {"type": "nominal", "axis": {"labelAngle": 0}, "field": "year", "scale": {"paddingInner": 0.1}}, "y": {"type": "quantitative", "axis": {"format": "$.4", "labelColor": "steelblue", "title": "Cashflow", "titleColor": "steelblue"}, "field": "x0", "scale": {"domain": [-1000, 100]}}, "y2": {"field": "x1"}}}, {"mark": "text", "encoding": {"text": {"type": "quantitative", "field": "cashflow", "format": "+$.5"}, "x": {"type": "nominal", "field": "year"}, "y": {"type": "quantitative", "axis": null, "field": "center"}}}, {"mark": {"type": "line", "color": "red", "opacity": 0.5, "strokeDash": [8, 3]}, "encoding": {"x": {"type": "nominal", "axis": {"labelAngle": 0}, "field": "year", "scale": {"paddingInner": 0.1}}, "y": {"type": "quantitative", "axis": {"labelColor": "red", "title": "Probability of default", "titleColor": "red"}, "field": "pd_profile", "scale": {"domain": [0, 0.16]}}}}], "data": {"name": "data-3d9a2397bdff9d91fbe86ee2d06fb6ed"}, "resolve": {"scale": {"y": "independent"}}, "title": "Transaction cashflows", "transform": [{"filter": "((datum.start_year <= selector021.year) && (datum.start_yearplus1 > selector021.year))"}], "width": 400}]}], "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-3d9a2397bdff9d91fbe86ee2d06fb6ed": [{"year": 0, "cashflow": -1000.0, "pd_profile": 0.0, "x1": -1000.0, "x0": 0.0, "center": -500.0, "next_year": 0, "irr": 0.022391017397208845, "start_year": 0, "start_yearplus1": 1}, {"year": 1, "cashflow": 250.0, "pd_profile": 0.05, "x1": -750.0, "x0": -1000.0, "center": -875.0, "next_year": 0, "irr": 0.022391017397208845, "start_year": 0, "start_yearplus1": 1}, {"year": 2, "cashflow": 268.64406779661016, "pd_profile": 0.08, "x1": -481.35593220338984, "x0": -750.0, "center": -615.6779661016949, "next_year": 1, "irr": 0.022391017397208845, "start_year": 0, "start_yearplus1": 1}, {"year": 3, "cashflow": 213.3659008992155, "pd_profile": 0.06, "x1": -267.99003130417435, "x0": -481.35593220338984, "center": -374.6729817537821, "next_year": 2, "irr": 0.022391017397208845, "start_year": 0, "start_yearplus1": 1}, {"year": 4, "cashflow": 180.51304012572882, "pd_profile": 0.05, "x1": -87.47699117844553, "x0": -267.99003130417435, "center": -177.73351124130994, "next_year": 3, "irr": 0.022391017397208845, "start_year": 0, "start_yearplus1": 1}, {"year": 5, "cashflow": 149.2483131435487, "pd_profile": 0.05, "x1": 61.77132196510317, "x0": -87.47699117844553, "center": -12.85283460667118, "next_year": 4, "irr": 0.022391017397208845, "start_year": 0, "start_yearplus1": 1}, {"year": 0, "cashflow": -1000.0, "pd_profile": 0.05, "x1": -1000.0, "x0": 0.0, "center": -500.0, "next_year": 0, "irr": 0.012854610470414076, "start_year": 1, "start_yearplus1": 2}, {"year": 1, "cashflow": 268.7199462726662, "pd_profile": 0.08, "x1": -731.2800537273338, "x0": -1000.0, "center": -865.6400268636669, "next_year": 0, "irr": 0.012854610470414076, "start_year": 1, "start_yearplus1": 2}, {"year": 2, "cashflow": 255.77415980098183, "pd_profile": 0.06, "x1": -475.505893926352, "x0": -731.2800537273338, "center": -603.3929738268429, "next_year": 1, "irr": 0.012854610470414076, "start_year": 1, "start_yearplus1": 2}, {"year": 3, "cashflow": 203.8186356138588, "pd_profile": 0.05, "x1": -271.6872583124932, "x0": -475.505893926352, "center": -373.5965761194226, "next_year": 2, "irr": 0.012854610470414076, "start_year": 1, "start_yearplus1": 2}, {"year": 4, "cashflow": 165.30942237694916, "pd_profile": 0.05, "x1": -106.37783593554406, "x0": -271.6872583124932, "center": -189.03254712401863, "next_year": 3, "irr": 0.012854610470414076, "start_year": 1, "start_yearplus1": 2}, {"year": 5, "cashflow": 140.84914980622244, "pd_profile": 0.07, "x1": 34.47131387067839, "x0": -106.37783593554406, "center": -35.953261032432835, "next_year": 4, "irr": 0.012854610470414076, "start_year": 1, "start_yearplus1": 2}, {"year": 0, "cashflow": -1000.0, "pd_profile": 0.08, "x1": -1000.0, "x0": 0.0, "center": -500.0, "next_year": 0, "irr": 0.013137026977068875, "start_year": 2, "start_yearplus1": 3}, {"year": 1, "cashflow": 293.1099050203528, "pd_profile": 0.06, "x1": -706.8900949796472, "x0": -1000.0, "center": -853.4450474898235, "next_year": 0, "irr": 0.013137026977068875, "start_year": 2, "start_yearplus1": 3}, {"year": 2, "cashflow": 224.84438005447387, "pd_profile": 0.05, "x1": -482.04571492517334, "x0": -706.8900949796472, "center": -594.4679049524102, "next_year": 1, "irr": 0.013137026977068875, "start_year": 2, "start_yearplus1": 3}, {"year": 3, "cashflow": 197.8106270884346, "pd_profile": 0.05, "x1": -284.2350878367388, "x0": -482.04571492517334, "center": -383.14040138095606, "next_year": 2, "irr": 0.013137026977068875, "start_year": 2, "start_yearplus1": 3}, {"year": 4, "cashflow": 169.56370941132639, "pd_profile": 0.07, "x1": -114.6713784254124, "x0": -284.2350878367388, "center": -199.4532331310756, "next_year": 3, "irr": 0.013137026977068875, "start_year": 2, "start_yearplus1": 3}, {"year": 5, "cashflow": 149.9593293034025, "pd_profile": 0.08, "x1": 35.28795087799011, "x0": -114.6713784254124, "center": -39.69171377371114, "next_year": 4, "irr": 0.013137026977068875, "start_year": 2, "start_yearplus1": 3}, {"year": 0, "cashflow": -1000.0, "pd_profile": 0.06, "x1": -1000.0, "x0": 0.0, "center": -500.0, "next_year": 0, "irr": 0.019918128985962597, "start_year": 3, "start_yearplus1": 4}, {"year": 1, "cashflow": 276.9973045822103, "pd_profile": 0.05, "x1": -723.0026954177897, "x0": -1000.0, "center": -861.5013477088949, "next_year": 0, "irr": 0.019918128985962597, "start_year": 3, "start_yearplus1": 4}, {"year": 2, "cashflow": 234.84352611915313, "pd_profile": 0.05, "x1": -488.1591692986366, "x0": -723.0026954177897, "center": -605.5809323582132, "next_year": 1, "irr": 0.019918128985962597, "start_year": 3, "start_yearplus1": 4}, {"year": 3, "cashflow": 208.7742522438171, "pd_profile": 0.07, "x1": -279.3849170548195, "x0": -488.1591692986366, "center": -383.77204317672806, "next_year": 2, "irr": 0.019918128985962597, "start_year": 3, "start_yearplus1": 4}, {"year": 4, "cashflow": 182.0800056881411, "pd_profile": 0.08, "x1": -97.30491136667837, "x0": -279.3849170548195, "center": -188.34491421074893, "next_year": 3, "irr": 0.019918128985962597, "start_year": 3, "start_yearplus1": 4}, {"year": 5, "cashflow": 151.86485155212858, "pd_profile": 0.11, "x1": 54.559940185450216, "x0": -97.30491136667837, "center": -21.372485590614076, "next_year": 4, "irr": 0.019918128985962597, "start_year": 3, "start_yearplus1": 4}, {"year": 0, "cashflow": -1000.0, "pd_profile": 0.05, "x1": -1000.0, "x0": 0.0, "center": -500.0, "next_year": 0, "irr": 0.009193846456827187, "start_year": 4, "start_yearplus1": 5}, {"year": 1, "cashflow": 276.9973045822103, "pd_profile": 0.05, "x1": -723.0026954177897, "x0": -1000.0, "center": -861.5013477088949, "next_year": 0, "irr": 0.009193846456827187, "start_year": 4, "start_yearplus1": 5}, {"year": 2, "cashflow": 240.3590204344921, "pd_profile": 0.07, "x1": -482.6436749832976, "x0": -723.0026954177897, "center": -602.8231852005437, "next_year": 1, "irr": 0.009193846456827187, "start_year": 4, "start_yearplus1": 5}, {"year": 3, "cashflow": 210.20627739483047, "pd_profile": 0.08, "x1": -272.43739758846715, "x0": -482.6436749832976, "center": -377.54053628588235, "next_year": 2, "irr": 0.009193846456827187, "start_year": 4, "start_yearplus1": 5}, {"year": 4, "cashflow": 165.41828827992114, "pd_profile": 0.11, "x1": -107.019109308546, "x0": -272.43739758846715, "center": -189.72825344850656, "next_year": 3, "irr": 0.009193846456827187, "start_year": 4, "start_yearplus1": 5}, {"year": 5, "cashflow": 131.41897299497305, "pd_profile": 0.12, "x1": 24.39986368642704, "x0": -107.019109308546, "center": -41.309622811059484, "next_year": 4, "irr": 0.009193846456827187, "start_year": 4, "start_yearplus1": 5}, {"year": 0, "cashflow": -1000.0, "pd_profile": 0.05, "x1": -1000.0, "x0": 0.0, "center": -500.0, "next_year": 0, "irr": 0.007720260068883195, "start_year": 5, "start_yearplus1": 6}, {"year": 1, "cashflow": 276.9973045822103, "pd_profile": 0.07, "x1": -723.0026954177897, "x0": -1000.0, "center": -861.5013477088949, "next_year": 0, "irr": 0.007720260068883195, "start_year": 5, "start_yearplus1": 6}, {"year": 2, "cashflow": 243.6118390598937, "pd_profile": 0.08, "x1": -479.39085635789604, "x0": -723.0026954177897, "center": -601.1967758878429, "next_year": 1, "irr": 0.007720260068883195, "start_year": 5, "start_yearplus1": 6}, {"year": 3, "cashflow": 203.7335155416134, "pd_profile": 0.11, "x1": -275.6573408162826, "x0": -479.39085635789604, "center": -377.5240985870893, "next_year": 2, "irr": 0.007720260068883195, "start_year": 5, "start_yearplus1": 6}, {"year": 4, "cashflow": 168.83517459025245, "pd_profile": 0.12, "x1": -106.82216622603016, "x0": -275.6573408162826, "center": -191.2397535211564, "next_year": 3, "irr": 0.007720260068883195, "start_year": 5, "start_yearplus1": 6}, {"year": 5, "cashflow": 127.2233181510665, "pd_profile": 0.1, "x1": 20.40115192503633, "x0": -106.82216622603016, "center": -43.210507150496916, "next_year": 4, "irr": 0.007720260068883195, "start_year": 5, "start_yearplus1": 6}, {"year": 0, "cashflow": -1000.0, "pd_profile": 0.07, "x1": -1000.0, "x0": 0.0, "center": -500.0, "next_year": 0, "irr": 0.0053063255047502015, "start_year": 6, "start_yearplus1": 7}, {"year": 1, "cashflow": 283.51351351351354, "pd_profile": 0.08, "x1": -716.4864864864865, "x0": -1000.0, "center": -858.2432432432432, "next_year": 0, "irr": 0.0053063255047502015, "start_year": 6, "start_yearplus1": 7}, {"year": 2, "cashflow": 232.58860850757034, "pd_profile": 0.11, "x1": -483.8978779789161, "x0": -716.4864864864865, "center": -600.1921822327013, "next_year": 1, "irr": 0.0053063255047502015, "start_year": 6, "start_yearplus1": 7}, {"year": 3, "cashflow": 210.73661376198635, "pd_profile": 0.12, "x1": -273.16126421692974, "x0": -483.8978779789161, "center": -378.52957109792294, "next_year": 2, "irr": 0.0053063255047502015, "start_year": 6, "start_yearplus1": 7}, {"year": 4, "cashflow": 161.90633259794092, "pd_profile": 0.1, "x1": -111.25493161898882, "x0": -273.16126421692974, "center": -192.20809791795926, "next_year": 3, "irr": 0.0053063255047502015, "start_year": 6, "start_yearplus1": 7}, {"year": 5, "cashflow": 125.18011104086091, "pd_profile": 0.08, "x1": 13.925179421872087, "x0": -111.25493161898882, "center": -48.664876098558366, "next_year": 4, "irr": 0.0053063255047502015, "start_year": 6, "start_yearplus1": 7}, {"year": 0, "cashflow": -1000.0, "pd_profile": 0.08, "x1": -1000.0, "x0": 0.0, "center": -500.0, "next_year": 0, "irr": -0.008068642180132193, "start_year": 7, "start_yearplus1": 8}, {"year": 1, "cashflow": 291.5254237288135, "pd_profile": 0.11, "x1": -708.4745762711865, "x0": -1000.0, "center": -854.2372881355932, "next_year": 0, "irr": -0.008068642180132193, "start_year": 7, "start_yearplus1": 8}, {"year": 2, "cashflow": 243.73619764776998, "pd_profile": 0.12, "x1": -464.7383786234165, "x0": -708.4745762711865, "center": -586.6064774473015, "next_year": 1, "irr": -0.008068642180132193, "start_year": 7, "start_yearplus1": 8}, {"year": 3, "cashflow": 186.8940274826537, "pd_profile": 0.1, "x1": -277.8443511407628, "x0": -464.7383786234165, "center": -371.2913648820896, "next_year": 2, "irr": -0.008068642180132193, "start_year": 7, "start_yearplus1": 8}, {"year": 4, "cashflow": 144.39778028998745, "pd_profile": 0.08, "x1": -133.44657085077534, "x0": -277.8443511407628, "center": -205.64546099576907, "next_year": 3, "irr": -0.008068642180132193, "start_year": 7, "start_yearplus1": 8}, {"year": 5, "cashflow": 113.06602501761661, "pd_profile": 0.05, "x1": -20.380545833158735, "x0": -133.44657085077534, "center": -76.91355834196705, "next_year": 4, "irr": -0.008068642180132193, "start_year": 7, "start_yearplus1": 8}, {"year": 0, "cashflow": -1000.0, "pd_profile": 0.11, "x1": -1000.0, "x0": 0.0, "center": -500.0, "next_year": 0, "irr": -0.014042664007686582, "start_year": 8, "start_yearplus1": 9}, {"year": 1, "cashflow": 304.0327198364008, "pd_profile": 0.12, "x1": -695.9672801635992, "x0": -1000.0, "center": -847.9836400817996, "next_year": 0, "irr": -0.014042664007686582, "start_year": 8, "start_yearplus1": 9}, {"year": 2, "cashflow": 232.62302020599986, "pd_profile": 0.1, "x1": -463.3442599575993, "x0": -695.9672801635992, "center": -579.6557700605993, "next_year": 1, "irr": -0.014042664007686582, "start_year": 8, "start_yearplus1": 9}, {"year": 3, "cashflow": 180.63182212379525, "pd_profile": 0.08, "x1": -282.7124378338041, "x0": -463.3442599575993, "center": -373.0283488957017, "next_year": 2, "irr": -0.014042664007686582, "start_year": 8, "start_yearplus1": 9}, {"year": 4, "cashflow": 138.67141968066136, "pd_profile": 0.05, "x1": -144.04101815314272, "x0": -282.7124378338041, "center": -213.3767279934734, "next_year": 3, "irr": -0.014042664007686582, "start_year": 8, "start_yearplus1": 9}, {"year": 5, "cashflow": 109.14128051220658, "pd_profile": 0.06, "x1": -34.89973764093614, "x0": -144.04101815314272, "center": -89.47037789703943, "next_year": 4, "irr": -0.014042664007686582, "start_year": 8, "start_yearplus1": 9}, {"year": 0, "cashflow": -1000.0, "pd_profile": 0.12, "x1": -1000.0, "x0": 0.0, "center": -500.0, "next_year": 0, "irr": 0.000607272145981628, "start_year": 9, "start_yearplus1": 10}, {"year": 1, "cashflow": 296.2608695652174, "pd_profile": 0.1, "x1": -703.7391304347826, "x0": -1000.0, "center": -851.8695652173913, "next_year": 0, "irr": 0.000607272145981628, "start_year": 9, "start_yearplus1": 10}, {"year": 2, "cashflow": 233.2030415285631, "pd_profile": 0.08, "x1": -470.53608890621956, "x0": -703.7391304347826, "center": -587.1376096705011, "next_year": 1, "irr": 0.000607272145981628, "start_year": 9, "start_yearplus1": 10}, {"year": 3, "cashflow": 189.04042954642844, "pd_profile": 0.05, "x1": -281.49565935979115, "x0": -470.53608890621956, "center": -376.01587413300535, "next_year": 2, "irr": 0.000607272145981628, "start_year": 9, "start_yearplus1": 10}, {"year": 4, "cashflow": 151.40888460496876, "pd_profile": 0.06, "x1": -130.0867747548224, "x0": -281.49565935979115, "center": -205.79121705730677, "next_year": 3, "irr": 0.000607272145981628, "start_year": 9, "start_yearplus1": 10}, {"year": 5, "cashflow": 131.6598005533861, "pd_profile": 0.07, "x1": 1.5730257985637195, "x0": -130.0867747548224, "center": -64.25687447812933, "next_year": 4, "irr": 0.000607272145981628, "start_year": 9, "start_yearplus1": 10}, {"year": 0, "cashflow": -1000.0, "pd_profile": 0.1, "x1": -1000.0, "x0": 0.0, "center": -500.0, "next_year": 0, "irr": 0.005341182660551728, "start_year": 10, "start_yearplus1": 11}, {"year": 1, "cashflow": 293.1099050203528, "pd_profile": 0.08, "x1": -706.8900949796472, "x0": -1000.0, "center": -853.4450474898235, "next_year": 0, "irr": 0.005341182660551728, "start_year": 10, "start_yearplus1": 11}, {"year": 2, "cashflow": 233.37325493743404, "pd_profile": 0.05, "x1": -473.5168400422132, "x0": -706.8900949796472, "center": -590.2034675109302, "next_year": 1, "irr": 0.005341182660551728, "start_year": 10, "start_yearplus1": 11}, {"year": 3, "cashflow": 188.9021533146204, "pd_profile": 0.06, "x1": -284.6146867275928, "x0": -473.5168400422132, "center": -379.065763384903, "next_year": 2, "irr": 0.005341182660551728, "start_year": 10, "start_yearplus1": 11}, {"year": 4, "cashflow": 163.5269280383602, "pd_profile": 0.07, "x1": -121.0877586892326, "x0": -284.6146867275928, "center": -202.8512227084127, "next_year": 3, "irr": 0.005341182660551728, "start_year": 10, "start_yearplus1": 11}, {"year": 5, "cashflow": 135.11170329426054, "pd_profile": 0.07, "x1": 14.023944605027935, "x0": -121.0877586892326, "center": -53.53190704210233, "next_year": 4, "irr": 0.005341182660551728, "start_year": 10, "start_yearplus1": 11}], "data-6fe77d56cec7e6c5eb876c8fd2c278ac": [{"year": 0, "start_year": 0, "pd_profile": 0.0, "yearmin5": -5}, {"year": 1, "start_year": 1, "pd_profile": 0.05, "yearmin5": -4}, {"year": 2, "start_year": 2, "pd_profile": 0.08, "yearmin5": -3}, {"year": 3, "start_year": 3, "pd_profile": 0.06, "yearmin5": -2}, {"year": 4, "start_year": 4, "pd_profile": 0.05, "yearmin5": -1}, {"year": 5, "start_year": 5, "pd_profile": 0.05, "yearmin5": 0}, {"year": 6, "start_year": 6, "pd_profile": 0.07, "yearmin5": 1}, {"year": 7, "start_year": 7, "pd_profile": 0.08, "yearmin5": 2}, {"year": 8, "start_year": 8, "pd_profile": 0.11, "yearmin5": 3}, {"year": 9, "start_year": 9, "pd_profile": 0.12, "yearmin5": 4}, {"year": 10, "start_year": 10, "pd_profile": 0.1, "yearmin5": 5}, {"year": 11, "start_year": 11, "pd_profile": 0.08, "yearmin5": 6}, {"year": 12, "start_year": 12, "pd_profile": 0.05, "yearmin5": 7}, {"year": 13, "start_year": 13, "pd_profile": 0.06, "yearmin5": 8}, {"year": 14, "start_year": 14, "pd_profile": 0.07, "yearmin5": 9}, {"year": 15, "start_year": 15, "pd_profile": 0.07, "yearmin5": 10}]}};
      var embedOpt = {"mode": "vega-lite"};

      function showError(el, error){
          el.innerHTML = ('<div class="error" style="color:red;">'
                          + '<p>JavaScript Error: ' + error.message + '</p>'
                          + "<p>This usually means there's a typo in your chart specification. "
                          + "See the javascript console for the full traceback.</p>"
                          + '</div>');
          throw error;
      }
      const el = document.getElementById('vis');
      vegaEmbed("#vis", spec, embedOpt)
        .catch(error => showError(el, error));
    })(vegaEmbed);

  </script>
</body>
</html>